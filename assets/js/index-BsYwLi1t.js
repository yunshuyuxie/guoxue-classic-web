const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/QuoteShake-Bcf8pADT.js","assets/js/vue-2Nd6u6r3.js","assets/js/tiny-B--Sm0qK.js","assets/css/tiny-bJ4gvHvs.css","assets/css/QuoteShake-zY-9_SM0.css","assets/js/AboutView-8RI5PRZf.js","assets/css/AboutView-B4Al6d9I.css","assets/js/BookDetailView-bVOdNF0R.js","assets/css/BookDetailView-DsY7EEUS.css","assets/js/BookReadView-D2M1fTSy.js","assets/css/BookReadView-Dv73uMmh.css","assets/js/BooksView-BQPU9eZm.js","assets/css/BooksView-BAccHtKo.css","assets/js/CommunityView-Vj-TuDWg.js","assets/css/CommunityView-D0s7-6Xh.css","assets/js/CoursesView-CPsEwRea.js","assets/css/CoursesView-GgT3Dofu.css","assets/js/FestivalView-Ci9Q-vB7.js","assets/js/ForgotPasswordView-BYcJaDWI.js","assets/css/ForgotPasswordView-iu_A4-T9.css","assets/js/HomeView-C1COsMVF.js","assets/css/HomeView-B-ARor8I.css","assets/js/ImagesTestView-CDcPWyau.js","assets/css/ImagesTestView-CVuGl8qW.css","assets/js/LearningCenterView-TCn3XLHL.js","assets/css/LearningCenterView-ax3ZcmEH.css","assets/js/LoginView-BzyKDJOK.js","assets/css/LoginView-oYrvN25d.css","assets/js/QuizPlayView-CjSctacW.js","assets/css/QuizPlayView-BFOZpAOs.css","assets/js/QuizResultView-sjApU7tz.js","assets/css/QuizResultView-mD5_oKYC.css","assets/js/QuizView-w6AxkOQP.js","assets/css/QuizView-msT1gSed.css","assets/js/QuotesView-BnBeXo-P.js","assets/css/QuotesView-7qCsWLLa.css","assets/js/RegisterView-D0DJhd1F.js","assets/css/RegisterView-DGC_3HAj.css","assets/js/UserOnboardingView-BfuCy4ES.js","assets/css/UserOnboardingView-94kn5TbA.css","assets/js/UserProfileView-DpZ7gHr5.js","assets/css/UserProfileView-BGikfoJQ.css"])))=>i.map(i=>d[i]);
import{d as Q,f as V,l as N,v as y,A as O,x as e,F as U,I as ae,a7 as ne,O as K,P as Y,a8 as S,w as h,a9 as se,aa as le,b as w,z,H as A,j as D,a as ue,D as F,L as X,K as ce,ab as Z,ac as de,ad as me,$ as ve,Q as B,ae as _e,af as pe}from"./vue-2Nd6u6r3.js";import{i as fe}from"./tiny-B--Sm0qK.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function t(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerPolicy&&(n.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?n.credentials="include":a.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(a){if(a.ep)return;a.ep=!0;const n=t(a);fetch(a.href,n)}})();const he="modulepreload",ge=function(r){return"/guoxue-classic-web/"+r},J={},l=function(i,t,o){let a=Promise.resolve();if(t&&t.length>0){let s=function(c){return Promise.all(c.map(p=>Promise.resolve(p).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),v=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));a=s(t.map(c=>{if(c=ge(c),c in J)return;J[c]=!0;const p=c.endsWith(".css"),g=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${g}`))return;const m=document.createElement("link");if(m.rel=p?"stylesheet":he,p||(m.as="script"),m.crossOrigin="",m.href=c,v&&m.setAttribute("nonce",v),document.head.appendChild(m),p)return new Promise((b,x)=>{m.addEventListener("load",b),m.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${c}`)))})}))}function n(s){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=s,window.dispatchEvent(u),!u.defaultPrevented)throw s}return a.then(s=>{for(const u of s||[])u.status==="rejected"&&n(u.reason);return i().catch(n)})},_={BOOK_COVER:"book-cover",AVATAR:"avatar",ARTICLE:"article",BANNER:"banner",QUOTE:"quote",DEFAULT:"default"},ee={[_.BOOK_COVER]:{width:200,height:300,bgColor:"#f9e9d6",textColor:"#842029",text:"经典书籍",fontSize:18},[_.AVATAR]:{width:120,height:120,bgColor:"#e6f7ff",textColor:"#842029",text:"用户头像",fontSize:14},[_.ARTICLE]:{width:800,height:450,bgColor:"#f0f7ec",textColor:"#842029",text:"文章配图",fontSize:24},[_.BANNER]:{width:1200,height:300,bgColor:"#eae2d8",textColor:"#842029",text:"国学经典",fontSize:36},[_.QUOTE]:{width:600,height:400,bgColor:"#f5f5f5",textColor:"#842029",text:"经典名句",fontSize:24},[_.DEFAULT]:{width:300,height:200,bgColor:"#f7f7f7",textColor:"#842029",text:"图片加载失败",fontSize:16}};function H(r=_.DEFAULT,i,t){const o=ee[r]||ee[_.DEFAULT],a=i||o.text,n=document.createElement("canvas");n.width=o.width,n.height=o.height;const s=n.getContext("2d");if(!s)return"";s.fillStyle=o.bgColor,s.fillRect(0,0,o.width,o.height),s.strokeStyle=o.textColor,s.lineWidth=3,s.strokeRect(5,5,o.width-10,o.height-10),s.fillStyle=o.textColor,s.font=`${o.fontSize}px "STXihei", "Microsoft YaHei", sans-serif`,s.textAlign="center",s.textBaseline="middle";const u=a.split(`
`),v=o.fontSize*1.5,c=o.height/2-(u.length-1)*v/2;u.forEach((g,m)=>{s.fillText(g,o.width/2,c+m*v)});const p=n.toDataURL("image/png");return t&&we(p,t),p}function we(r,i){const t=document.createElement("a");t.href=r,t.download=i.endsWith(".png")?i:`${i}.png`,document.body.appendChild(t),t.click(),document.body.removeChild(t)}function te(r,i=_.DEFAULT,t){const o=t||r.src,n=oe(o).match(/([^\/]+)(?:\.\w+)?$/),s=n?decodeURIComponent(n[1]).replace(/[-_]/g," "):"图片加载失败",u=H(i,s);r.src=u,r.setAttribute("data-original-src",o),r.setAttribute("title",`原图加载失败: ${s}`),r.onclick=()=>{const v=r.getAttribute("data-original-src");v&&(r.src=v)}}function oe(r){try{return new URL(r).pathname.split("/").pop()||"unknown"}catch{return r.split("/").pop()||"unknown"}}function Ee(){document.addEventListener("error",r=>{const i=r.target;if(i.tagName==="IMG"){const t=i;let o=_.DEFAULT;t.classList.contains("book-cover")?o=_.BOOK_COVER:t.classList.contains("avatar")?o=_.AVATAR:t.classList.contains("article-img")?o=_.ARTICLE:t.classList.contains("banner")?o=_.BANNER:t.classList.contains("quote-img")&&(o=_.QUOTE),te(t,o)}},!0)}function Ae(r,i=_.DEFAULT){r.forEach((t,o)=>{const a=oe(t),n=`图片加载失败
${a}`;H(i,n,`placeholder-${o+1}-${a}`)})}const k={generatePlaceholderImage:H,handleImageError:te,initGlobalImageErrorHandler:Ee,batchGeneratePlaceholders:Ae,IMAGE_TYPES:_},Ve={key:0,class:"image-error-handler"},be={class:"handler-header"},ye={class:"badge"},Le={class:"handler-content"},Re={class:"control-panel"},Ie={class:"form-group"},Te=["value"],Pe={class:"failed-images-list"},Oe={class:"image-url"},ke=["onClick"],De=Q({__name:"ImageErrorHandler",setup(r){const i=V([]),t=V("default"),o=Object.keys(k.IMAGE_TYPES),a=()=>{i.value=Array.from(document.querySelectorAll("img[data-original-src]")).map(u=>u.getAttribute("data-original-src")).filter(Boolean)},n=()=>{i.value.length>0&&k.batchGeneratePlaceholders(i.value,t.value)},s=(u,v)=>{const c=u.split("/").pop()||`image-${v}`;k.generatePlaceholderImage(t.value,`图片${v+1}
${c}`,`placeholder-${v+1}`)};return N(()=>{setTimeout(a,1e3),document.addEventListener("error",u=>{u.target instanceof HTMLImageElement&&setTimeout(a,200)},!0)}),(u,v)=>i.value.length>0?(h(),y("div",Ve,[e("div",be,[v[1]||(v[1]=e("h3",null,"图片错误处理工具",-1)),e("span",ye,U(i.value.length),1)]),e("div",Le,[e("div",Re,[e("div",Ie,[v[2]||(v[2]=e("label",{for:"placeholderType"},"占位图类型：",-1)),ae(e("select",{id:"placeholderType","onUpdate:modelValue":v[0]||(v[0]=c=>t.value=c)},[(h(!0),y(K,null,Y(S(o),c=>(h(),y("option",{key:c,value:c},U(c),9,Te))),128))],512),[[ne,t.value]])]),e("button",{class:"generate-all-button",onClick:n},"生成所有占位图"),e("button",{class:"refresh-button",onClick:a},"刷新列表")]),e("div",Pe,[(h(!0),y(K,null,Y(i.value,(c,p)=>(h(),y("div",{key:c,class:"failed-image-item"},[e("div",Oe,U(c),1),e("button",{class:"generate-button",onClick:g=>s(c,p)}," 生成 ",8,ke)]))),128))])])])):O("",!0)}}),M=(r,i)=>{const t=r.__vccOpts||r;for(const[o,a]of i)t[o]=a;return t},Ce=M(De,[["__scopeId","data-v-e7ce8adc"]]),qe={class:"header-content"},ze={class:"tiny-menu-demo"},Se={class:"user-actions"},$e={key:0,class:"mobile-nav"},xe=15,Ue=Q({__name:"App",setup(r){const i=ue(()=>l(()=>import("./QuoteShake-Bcf8pADT.js"),__vite__mapDeps([0,1,2,3,4]))),t=V([{title:"首页",url:"/",id:"1"},{title:"经典书籍",url:"/books",id:"2"},{title:"知识测验",url:"/quiz",id:"3"},{title:"国学讲堂",url:"/courses",id:"4"},{title:"学习社区",url:"/community",id:"5"},{title:"学习中心",url:"/learning-center",id:"6"},{title:"关于我们",url:"/about",id:"7"}]),o=se(),a=V(""),n=V(!1),s=()=>{n.value=window.innerWidth<=768},u=V(!1);let v=0,c=0,p=0,g=0;const m=E=>{const d=Date.now();if(d-v>100){const L=E.accelerationIncludingGravity;if(L){const I=L.x||0,R=L.y||0,q=L.z||0,T=d-v;Math.abs(I+R+q-c-p-g)/T*1e4>xe&&b(),c=I,p=R,g=q,v=d}}},b=()=>{u.value=!0},x=()=>{u.value=!1};function re(E,d){let L=0;return function(...I){const R=Date.now();R-L>=d&&(L=R,E(...I))}}const G=re(s,200),W=()=>["/","/books","/login","/register"].includes(o.path);return N(()=>{const E=t.value.find(d=>d.url===o.path);E!=null&&E.id?a.value=E.id:a.value="1",s(),window.addEventListener("resize",G),window.DeviceMotionEvent&&n.value&&window.addEventListener("devicemotion",m)}),le(()=>{window.removeEventListener("resize",G),window.DeviceMotionEvent&&window.removeEventListener("devicemotion",m)}),(E,d)=>{const L=D("tiny-nav-menu"),I=D("tiny-button"),R=D("tiny-row"),q=D("tiny-layout"),T=D("router-link");return h(),y("div",{class:F(["common-layout",{"is-mobile":n.value}])},[w(q,null,{default:A(()=>[w(R,null,{default:A(()=>[e("div",qe,[d[4]||(d[4]=e("div",{class:"logo"},[e("h1",null,"国学经典")],-1)),e("div",ze,[w(L,{data:t.value,defaultActive:a.value,"allow-full-url":"",overflow:"fiexd"},null,8,["data","defaultActive"])]),e("div",Se,[w(I,{type:"primary",plain:"",size:"small",onClick:d[0]||(d[0]=j=>E.$router.push("/login"))},{default:A(()=>d[2]||(d[2]=[X("登录")])),_:1,__:[2]}),w(I,{type:"success",plain:"",size:"small",onClick:d[1]||(d[1]=j=>E.$router.push("/register"))},{default:A(()=>d[3]||(d[3]=[X("注册")])),_:1,__:[3]})])])]),_:1}),w(R,null,{default:A(()=>[(h(),z(ce,null,[W()?(h(),z(S(Z),{key:0})):O("",!0)],1024)),W()?O("",!0):(h(),z(S(Z),{key:0}))]),_:1}),w(R,null,{default:A(()=>d[5]||(d[5]=[e("div",{class:"footer-content"},[e("div",{class:"footer-logo"},[e("h2",null,"国学经典"),e("p",null,"传承国学经典，弘扬中华文化")]),e("div",{class:"footer-links"},[e("div",{class:"link-group"},[e("h3",null,"关于我们"),e("a",{href:"#"},"网站介绍"),e("a",{href:"#"},"联系方式"),e("a",{href:"#"},"加入我们")]),e("div",{class:"link-group"},[e("h3",null,"学习资源"),e("a",{href:"/books"},"经典书籍"),e("a",{href:"/quotes"},"名句赏析"),e("a",{href:"/courses"},"国学讲堂"),e("a",{href:"/quiz"},"知识测验")]),e("div",{class:"link-group"},[e("h3",null,"用户中心"),e("a",{href:"/learning-center"},"个人学习"),e("a",{href:"/community"},"学习社区"),e("a",{href:"/notes"},"学习笔记")])])],-1),e("div",{class:"copyright"},[e("p",null,"© 2023-2024 国学经典学习网站 - 传承中华文化，弘扬国学精神")],-1)])),_:1,__:[5]})]),_:1}),n.value?(h(),y("div",$e,[w(T,{to:"/",class:"nav-item"},{default:A(()=>d[6]||(d[6]=[e("i",{class:"mobile-nav-icon"},"🏠",-1),e("span",null,"首页",-1)])),_:1,__:[6]}),w(T,{to:"/books",class:"nav-item"},{default:A(()=>d[7]||(d[7]=[e("i",{class:"mobile-nav-icon"},"📚",-1),e("span",null,"书籍",-1)])),_:1,__:[7]}),w(T,{to:"/quiz",class:"nav-item"},{default:A(()=>d[8]||(d[8]=[e("i",{class:"mobile-nav-icon"},"📝",-1),e("span",null,"测验",-1)])),_:1,__:[8]}),w(T,{to:"/courses",class:"nav-item"},{default:A(()=>d[9]||(d[9]=[e("i",{class:"mobile-nav-icon"},"🎓",-1),e("span",null,"讲堂",-1)])),_:1,__:[9]}),w(T,{to:"/learning-center",class:"nav-item"},{default:A(()=>d[10]||(d[10]=[e("i",{class:"mobile-nav-icon"},"👤",-1),e("span",null,"我的",-1)])),_:1,__:[10]})])):O("",!0),u.value?(h(),z(S(i),{key:1,visible:u.value,onClose:x},null,8,["visible"])):O("",!0),w(Ce)],2)}}}),Be=M(Ue,[["__scopeId","data-v-4cbd0243"]]),ie=(r,i,t)=>{const o=r[i];return o?typeof o=="function"?o():Promise.resolve(o):new Promise((a,n)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(n.bind(null,new Error("Unknown variable dynamic import: "+i+(i.split("/").length!==t?". Note that variables only represent file names one level deep.":""))))})},P=r=>()=>{const i=()=>ie(Object.assign({"../views/AboutView.vue":()=>l(()=>import("./AboutView-8RI5PRZf.js"),__vite__mapDeps([5,1,2,3,6])),"../views/BookDetailView.vue":()=>l(()=>import("./BookDetailView-bVOdNF0R.js"),__vite__mapDeps([7,1,2,3,8])),"../views/BookReadView.vue":()=>l(()=>import("./BookReadView-D2M1fTSy.js"),__vite__mapDeps([9,1,2,3,10])),"../views/BooksView.vue":()=>l(()=>import("./BooksView-BQPU9eZm.js"),__vite__mapDeps([11,1,2,3,12])),"../views/CommunityView.vue":()=>l(()=>import("./CommunityView-Vj-TuDWg.js"),__vite__mapDeps([13,1,2,3,14])),"../views/CoursesView.vue":()=>l(()=>import("./CoursesView-CPsEwRea.js"),__vite__mapDeps([15,1,2,3,16])),"../views/FestivalView.vue":()=>l(()=>import("./FestivalView-Ci9Q-vB7.js"),__vite__mapDeps([17,1])),"../views/ForgotPasswordView.vue":()=>l(()=>import("./ForgotPasswordView-BYcJaDWI.js"),__vite__mapDeps([18,1,2,3,19])),"../views/HomeView.vue":()=>l(()=>import("./HomeView-C1COsMVF.js"),__vite__mapDeps([20,1,2,3,21])),"../views/ImagesTestView.vue":()=>l(()=>import("./ImagesTestView-CDcPWyau.js"),__vite__mapDeps([22,1,2,3,23])),"../views/LearningCenterView.vue":()=>l(()=>import("./LearningCenterView-TCn3XLHL.js"),__vite__mapDeps([24,1,2,3,25])),"../views/LoginView.vue":()=>l(()=>import("./LoginView-BzyKDJOK.js"),__vite__mapDeps([26,1,2,3,27])),"../views/QuizPlayView.vue":()=>l(()=>import("./QuizPlayView-CjSctacW.js"),__vite__mapDeps([28,1,2,3,29])),"../views/QuizResultView.vue":()=>l(()=>import("./QuizResultView-sjApU7tz.js"),__vite__mapDeps([30,1,2,3,31])),"../views/QuizView.vue":()=>l(()=>import("./QuizView-w6AxkOQP.js"),__vite__mapDeps([32,1,2,3,33])),"../views/QuotesView.vue":()=>l(()=>import("./QuotesView-BnBeXo-P.js"),__vite__mapDeps([34,1,2,3,35])),"../views/RegisterView.vue":()=>l(()=>import("./RegisterView-D0DJhd1F.js"),__vite__mapDeps([36,1,2,3,37])),"../views/UserOnboardingView.vue":()=>l(()=>import("./UserOnboardingView-BfuCy4ES.js"),__vite__mapDeps([38,1,2,3,39])),"../views/UserProfileView.vue":()=>l(()=>import("./UserProfileView-DpZ7gHr5.js"),__vite__mapDeps([40,1,2,3,41]))}),`../views/${r}.vue`,3);return i(),i()},f=r=>()=>ie(Object.assign({"../views/AboutView.vue":()=>l(()=>import("./AboutView-8RI5PRZf.js"),__vite__mapDeps([5,1,2,3,6])),"../views/BookDetailView.vue":()=>l(()=>import("./BookDetailView-bVOdNF0R.js"),__vite__mapDeps([7,1,2,3,8])),"../views/BookReadView.vue":()=>l(()=>import("./BookReadView-D2M1fTSy.js"),__vite__mapDeps([9,1,2,3,10])),"../views/BooksView.vue":()=>l(()=>import("./BooksView-BQPU9eZm.js"),__vite__mapDeps([11,1,2,3,12])),"../views/CommunityView.vue":()=>l(()=>import("./CommunityView-Vj-TuDWg.js"),__vite__mapDeps([13,1,2,3,14])),"../views/CoursesView.vue":()=>l(()=>import("./CoursesView-CPsEwRea.js"),__vite__mapDeps([15,1,2,3,16])),"../views/FestivalView.vue":()=>l(()=>import("./FestivalView-Ci9Q-vB7.js"),__vite__mapDeps([17,1])),"../views/ForgotPasswordView.vue":()=>l(()=>import("./ForgotPasswordView-BYcJaDWI.js"),__vite__mapDeps([18,1,2,3,19])),"../views/HomeView.vue":()=>l(()=>import("./HomeView-C1COsMVF.js"),__vite__mapDeps([20,1,2,3,21])),"../views/ImagesTestView.vue":()=>l(()=>import("./ImagesTestView-CDcPWyau.js"),__vite__mapDeps([22,1,2,3,23])),"../views/LearningCenterView.vue":()=>l(()=>import("./LearningCenterView-TCn3XLHL.js"),__vite__mapDeps([24,1,2,3,25])),"../views/LoginView.vue":()=>l(()=>import("./LoginView-BzyKDJOK.js"),__vite__mapDeps([26,1,2,3,27])),"../views/QuizPlayView.vue":()=>l(()=>import("./QuizPlayView-CjSctacW.js"),__vite__mapDeps([28,1,2,3,29])),"../views/QuizResultView.vue":()=>l(()=>import("./QuizResultView-sjApU7tz.js"),__vite__mapDeps([30,1,2,3,31])),"../views/QuizView.vue":()=>l(()=>import("./QuizView-w6AxkOQP.js"),__vite__mapDeps([32,1,2,3,33])),"../views/QuotesView.vue":()=>l(()=>import("./QuotesView-BnBeXo-P.js"),__vite__mapDeps([34,1,2,3,35])),"../views/RegisterView.vue":()=>l(()=>import("./RegisterView-D0DJhd1F.js"),__vite__mapDeps([36,1,2,3,37])),"../views/UserOnboardingView.vue":()=>l(()=>import("./UserOnboardingView-BfuCy4ES.js"),__vite__mapDeps([38,1,2,3,39])),"../views/UserProfileView.vue":()=>l(()=>import("./UserProfileView-DpZ7gHr5.js"),__vite__mapDeps([40,1,2,3,41]))}),`../views/${r}.vue`,3),$=de({history:me("/guoxue-classic-web/"),routes:[{path:"/",name:"home",component:P("HomeView"),meta:{title:"首页 - 国学经典",requiresAuth:!1}},{path:"/books",name:"books",component:P("BooksView"),meta:{title:"经典书籍 - 国学经典",requiresAuth:!1}},{path:"/book/:id",name:"book-detail",component:f("BookDetailView"),meta:{title:"书籍详情 - 国学经典",requiresAuth:!1}},{path:"/book/read/:id",name:"book-read",component:f("BookReadView"),meta:{title:"阅读经典 - 国学经典",requiresAuth:!1}},{path:"/quotes",name:"quotes",component:f("QuotesView"),meta:{title:"国学名句赏析 - 国学经典",requiresAuth:!1}},{path:"/login",name:"login",component:P("LoginView"),meta:{title:"登录 - 国学经典",requiresAuth:!1}},{path:"/register",name:"register",component:P("RegisterView"),meta:{title:"注册 - 国学经典",requiresAuth:!1}},{path:"/about",name:"about",component:f("AboutView"),meta:{title:"关于我们 - 国学经典",requiresAuth:!1}},{path:"/community",name:"community",component:f("CommunityView"),meta:{title:"学习社区 - 国学经典",requiresAuth:!1}},{path:"/learning-center",name:"learning-center",component:f("LearningCenterView"),meta:{title:"个人学习中心 - 国学经典",requiresAuth:!0}},{path:"/courses",name:"courses",component:f("CoursesView"),meta:{title:"国学讲堂 - 国学经典",requiresAuth:!1}},{path:"/quiz",name:"quiz",component:f("QuizView"),meta:{title:"国学知识测验 - 国学经典",requiresAuth:!1}},{path:"/quiz/:type",name:"quiz-play",component:f("QuizPlayView"),meta:{title:"答题中 - 国学经典",requiresAuth:!1}},{path:"/quiz/result/:id",name:"quiz-result",component:f("QuizResultView"),meta:{title:"测验结果 - 国学经典",requiresAuth:!1}},{path:"/quiz/leaderboard",name:"quiz-leaderboard",component:f("QuizView"),props:{activeTab:"leaderboard"},meta:{title:"排行榜 - 国学经典",requiresAuth:!1}},{path:"/quiz/history",name:"quiz-history",component:f("QuizView"),props:{activeTab:"history"},meta:{title:"测验历史 - 国学经典",requiresAuth:!0}},{path:"/quiz/review/:id",name:"quiz-review",component:f("QuizPlayView"),props:{isReviewMode:!0},meta:{title:"测验回顾 - 国学经典",requiresAuth:!0}},{path:"/festivals",name:"festivals",component:f("FestivalView"),meta:{title:"传统节日 - 国学经典",requiresAuth:!1}},{path:"/forgot-password",name:"forgot-password",component:P("ForgotPasswordView"),meta:{title:"找回密码 - 国学经典",requiresAuth:!1}},{path:"/onboarding",name:"onboarding",component:P("UserOnboardingView"),meta:{title:"新用户引导 - 国学经典",requiresAuth:!0}},{path:"/profile",name:"profile",component:P("UserProfileView"),meta:{title:"个人资料 - 国学经典",requiresAuth:!0}},{path:"/images-test",name:"images-test",component:f("ImagesTestView"),meta:{title:"图片测试 - 国学经典",requiresAuth:!1}},{path:"/:pathMatch(.*)*",name:"not-found",component:f("HomeView"),meta:{title:"页面未找到 - 国学经典",requiresAuth:!1}}],scrollBehavior(r,i,t){return t||(r.hash?{el:r.hash,behavior:"smooth"}:{top:0,behavior:"smooth"})}});$.beforeEach((r,i,t)=>{const o=localStorage.getItem("isLoggedIn")==="true";r.meta.requiresAuth&&!o?t({name:"login",query:{redirect:r.fullPath}}):o&&!localStorage.getItem("userOnboardingCompleted")&&r.name!=="onboarding"&&r.name!=="login"&&r.name!=="register"?t({name:"onboarding"}):(r.meta.title&&(document.title=r.meta.title),t())});const Fe=["src","alt","width","height","data-original-src","data-image-type"],Qe={key:0,class:"image-loading"},Ne={key:1,class:"image-error-actions"},He=Q({__name:"ImageWithFallback",props:{src:{},alt:{default:""},type:{default:"default"},width:{default:"auto"},height:{default:"auto"},class:{default:""},lazy:{type:Boolean,default:!0},retryOnClick:{type:Boolean,default:!0}},setup(r){const i=r,t=V(i.src),o=V(!1),a=V(!1),n=V(i.src),s=V(null),u=()=>{a.value=!0,s.value&&(k.handleImageError(s.value,i.type,n.value),s.value.getAttribute("data-original-src")!==n.value&&s.value.setAttribute("data-original-src",n.value))},v=()=>{o.value=!0,a.value=!1},c=()=>{i.retryOnClick&&a.value&&(t.value=n.value,a.value=!1,o.value=!1)},p=()=>{const m=`图片加载失败
${i.alt||"未知图片"}`,b=n.value.split("/").pop()||"image";k.generatePlaceholderImage(i.type,m,`placeholder-${b}`)},g=()=>{const m=Array.from(document.querySelectorAll("img[data-original-src]")).map(b=>b.getAttribute("data-original-src")).filter(Boolean);m.length>0&&k.batchGeneratePlaceholders(m,i.type)};return ve(()=>i.src,m=>{n.value=m,t.value=m,a.value=!1,o.value=!1}),N(()=>{s.value&&s.value.complete&&s.value.naturalWidth===0&&u()}),(m,b)=>(h(),y("div",{class:F(["image-wrapper",{"image-error":a.value,"image-loaded":o.value}])},[e("img",{ref_key:"imgRef",ref:s,src:t.value,alt:m.alt,width:m.width,height:m.height,class:F(["image-with-fallback",[m.lazy?"lazy":""]]),onError:u,onLoad:v,onClick:c,"data-original-src":n.value,"data-image-type":m.type},null,42,Fe),!o.value&&!a.value?(h(),y("div",Qe,b[0]||(b[0]=[e("div",{class:"spinner"},null,-1)]))):O("",!0),a.value?(h(),y("div",Ne,[e("button",{class:"retry-button",onClick:B(c,["stop"]),title:"重试加载"},"重试"),e("button",{class:"download-button",onClick:B(p,["stop"]),title:"下载占位图"}," 下载 "),e("button",{class:"generate-all-button",onClick:B(g,["stop"]),title:"下载所有失败图片的占位图"}," 全部下载 ")])):O("",!0)],2))}}),Me=M(He,[["__scopeId","data-v-d515020d"]]),C=_e(Be);C.use(pe());C.use($);C.use(fe);C.component("ImageWithFallback",Me);$.beforeEach((r,i,t)=>{t()});$.afterEach(r=>{});C.mount("#app");k.initGlobalImageErrorHandler();export{M as _,k as i};
