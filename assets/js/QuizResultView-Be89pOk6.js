import{d as $,c as m,v as u,x as t,A as k,F as i,O as b,P as C,J as R,b as D,j as L,H as T,L as Q,ag as P,w as c,aa as I,f as A,l as N}from"./vue-DO4TrDDV.js";import{_ as M}from"./index-D9k0mYov.js";import"./tiny-hb50Bj2_.js";const V={class:"quiz-result"},E={class:"result-header"},F={class:"result-title"},O={class:"result-time"},j={class:"result-overview"},H={class:"result-score-container"},J={class:"result-score"},U={class:"score-value"},G={class:"score-circle-container"},K={class:"score-circle",viewBox:"0 0 100 100"},W=["stroke-dasharray"],X={class:"score-percentage"},Y={class:"result-stats"},Z={class:"stat-item"},ee={class:"stat-value"},te={class:"stat-item"},se={class:"stat-value"},oe={class:"stat-item"},le={class:"stat-value"},re={class:"stat-item"},ie={class:"stat-value"},ne={key:0,class:"analysis-section"},ae={class:"knowledge-mastery"},ue={class:"mastery-header"},ce={class:"mastery-name"},de={class:"mastery-bar-container"},ve={class:"mastery-rate"},fe={class:"mastery-detail"},me={key:1,class:"analysis-section"},ye={class:"difficulty-distribution"},_e={class:"difficulty-header"},he={class:"difficulty-name"},ge={class:"difficulty-rate"},qe={class:"difficulty-bar-container"},pe={class:"difficulty-count"},we={class:"difficulty-bar-bg"},ke={key:2,class:"recommendation-section"},be={class:"recommendation-list"},Ce={class:"recommendation-content"},Re={class:"recommendation-title"},ze={class:"recommendation-type"},xe=$({__name:"QuizResult",props:{results:{type:Object,required:!0},quizType:{type:String,required:!0}},setup(d){const l=d,n=P(),v=m(()=>{if(!l.results.questions||l.results.questions.length===0)return 0;const r=l.results.questions.filter(e=>e.isCorrect).length;return Math.round(r/l.results.questions.length*100)}),y=m(()=>{if(!l.results.questions||l.results.questions.length===0)return 0;const r=Math.round(v.value/100*100),e=l.results.timeBonus||0,a=l.results.difficultyBonus||0;return r+e+a}),h=m(()=>{if(!l.results.questions||l.results.questions.length===0)return[];const r=new Map;return l.results.questions.forEach(e=>{e.knowledgePoints&&Array.isArray(e.knowledgePoints)&&e.knowledgePoints.forEach(a=>{r.has(a)||r.set(a,{name:a,total:0,correct:0});const f=r.get(a);f.total+=1,e.isCorrect&&(f.correct+=1)})}),Array.from(r.values()).map(e=>({...e,masteryRate:e.total>0?Math.round(e.correct/e.total*100):0,masteryLevel:p(e.total>0?Math.round(e.correct/e.total*100):0)})).sort((e,a)=>a.masteryRate-e.masteryRate)}),p=r=>r>=90?{level:"精通",color:"#4caf50"}:r>=70?{level:"熟练",color:"#8bc34a"}:r>=50?{level:"基础",color:"#ffc107"}:{level:"待加强",color:"#f44336"},g=m(()=>{if(!l.results.questions||l.results.questions.length===0)return[];const r=new Map;return l.results.questions.forEach(e=>{const a=e.difficulty||"普通";r.has(a)||r.set(a,{name:a,total:0,correct:0});const f=r.get(a);f.total+=1,e.isCorrect&&(f.correct+=1)}),Array.from(r.values()).map(e=>({...e,correctRate:e.total>0?Math.round(e.correct/e.total*100):0}))}),q=m(()=>h.value.filter(e=>e.masteryRate<70).slice(0,3).map(e=>({title:`${e.name}专题讲解`,type:"课程",link:`/courses?topic=${encodeURIComponent(e.name)}`}))),w=()=>{n.push(`/quiz/${l.quizType}`)},s=()=>{n.push(`/quiz/review/${l.results.id}?filter=incorrect`)},_=()=>{n.push("/quiz")},S=()=>{const r=`我在「国学经典」完成了${l.results.title}测验，获得了${y.value}分，正确率${v.value}%！`;try{navigator.clipboard.writeText(r).then(()=>{alert("结果已复制到剪贴板，可以分享给好友了！")})}catch(e){console.error("无法复制到剪贴板:",e),alert("无法复制到剪贴板，请手动复制分享！")}};return(r,e)=>{var f,z,x;const a=L("router-link");return c(),u("div",V,[t("div",E,[t("h2",F,i(d.results.title||"测验结果"),1),t("div",O," 完成时间: "+i(new Date(d.results.completedAt||Date.now()).toLocaleString("zh-CN")),1)]),t("div",j,[t("div",H,[t("div",J,[t("div",U,i(y.value),1),e[0]||(e[0]=t("div",{class:"score-label"},"总分",-1))]),t("div",G,[(c(),u("svg",K,[e[1]||(e[1]=t("circle",{class:"score-circle-bg",cx:"50",cy:"50",r:"45"},null,-1)),t("circle",{class:"score-circle-progress",cx:"50",cy:"50",r:"45","stroke-dasharray":`${v.value*2.83}, 283`},null,8,W)])),t("div",X,i(v.value)+"%",1)])]),t("div",Y,[t("div",Z,[t("div",ee,i(((f=d.results.questions)==null?void 0:f.length)||0),1),e[2]||(e[2]=t("div",{class:"stat-label"},"总题数",-1))]),t("div",te,[t("div",se,i(((z=d.results.questions)==null?void 0:z.filter(o=>o.isCorrect).length)||0),1),e[3]||(e[3]=t("div",{class:"stat-label"},"答对",-1))]),t("div",oe,[t("div",le,i(((x=d.results.questions)==null?void 0:x.filter(o=>!o.isCorrect).length)||0),1),e[4]||(e[4]=t("div",{class:"stat-label"},"答错",-1))]),t("div",re,[t("div",ie,i(d.results.timeSpent?Math.floor(d.results.timeSpent/60)+"分"+d.results.timeSpent%60+"秒":"-- --"),1),e[5]||(e[5]=t("div",{class:"stat-label"},"用时",-1))])])]),h.value.length>0?(c(),u("div",ne,[e[7]||(e[7]=t("h3",{class:"section-title"},"知识掌握分析",-1)),t("div",ae,[(c(!0),u(b,null,C(h.value,o=>(c(),u("div",{key:o.name,class:"mastery-item"},[t("div",ue,[t("div",ce,i(o.name),1),t("div",{class:"mastery-level",style:R({color:o.masteryLevel.color})},i(o.masteryLevel.level),5)]),t("div",de,[e[6]||(e[6]=t("div",{class:"mastery-bar-bg"},null,-1)),t("div",{class:"mastery-bar-progress",style:R({width:`${o.masteryRate}%`,backgroundColor:o.masteryLevel.color})},null,4),t("div",ve,i(o.masteryRate)+"%",1)]),t("div",fe,[t("span",null,"答对 "+i(o.correct)+"/"+i(o.total),1)])]))),128))])])):k("",!0),g.value.length>0?(c(),u("div",me,[e[8]||(e[8]=t("h3",{class:"section-title"},"难度分布",-1)),t("div",ye,[(c(!0),u(b,null,C(g.value,o=>(c(),u("div",{key:o.name,class:"difficulty-item"},[t("div",_e,[t("div",he,i(o.name),1),t("div",ge,"正确率: "+i(o.correctRate)+"%",1)]),t("div",qe,[t("div",pe,i(o.correct)+"/"+i(o.total),1),t("div",we,[t("div",{class:"difficulty-bar-progress",style:R({width:`${o.correctRate}%`})},null,4)])])]))),128))])])):k("",!0),q.value.length>0?(c(),u("div",ke,[e[11]||(e[11]=t("h3",{class:"section-title"},"推荐学习内容",-1)),t("div",be,[(c(!0),u(b,null,C(q.value,(o,B)=>(c(),u("div",{key:B,class:"recommendation-item"},[e[10]||(e[10]=t("div",{class:"recommendation-icon"},"📚",-1)),t("div",Ce,[t("div",Re,i(o.title),1),t("div",ze,i(o.type),1)]),D(a,{to:o.link,class:"recommendation-link"},{default:T(()=>e[9]||(e[9]=[Q(" 查看 ")])),_:2,__:[9]},1032,["to"])]))),128))])])):k("",!0),t("div",{class:"actions-container"},[t("button",{class:"action-button retry",onClick:w},"重新测验"),t("button",{class:"action-button review",onClick:s},"查看错题"),t("button",{class:"action-button share",onClick:S},"分享结果"),t("button",{class:"action-button home",onClick:_},"返回主页")])])}}}),Ae=M(xe,[["__scopeId","data-v-32066479"]]),$e={class:"quiz-result-view"},De={key:0,class:"loading-container"},Pe={key:1,class:"result-container"},Me=$({__name:"QuizResultView",setup(d){const l=I();P();const n=m(()=>l.params.id),v=A(null),y=A(!0),h=()=>{if(l.query&&l.query.state&&typeof l.query.state=="string")try{const s=JSON.parse(l.query.state);if(s.results){v.value=s.results,y.value=!1;return}}catch(s){console.error("Failed to parse state data",s)}setTimeout(()=>{n.value.includes("daily")?v.value=p():n.value.includes("challenge")?v.value=g():v.value=q(),y.value=!1},1e3)},p=()=>({id:n.value,title:"每日一题",completedAt:new Date,timeSpent:45,questions:[{id:1001,question:'《论语》"学而时习之，不亦说乎"中的"说"字应解释为：',options:["悦","阅","说","税"],answer:0,userAnswer:0,isCorrect:!0,explanation:'"说"通"悦"，表示高兴、愉快的意思。这句话的意思是"学习知识并且经常温习它，不也是很快乐的事情吗？"',source:"《论语·学而》",difficulty:"入门级",knowledgePoints:["《论语》","古文字通假"]}]}),g=()=>({id:n.value,title:"进阶挑战",completedAt:new Date,timeSpent:180,timeBonus:20,difficultyBonus:30,questions:[{id:501,question:"《三字经》开头的句子是：",options:["人之初，性本善","天地玄黄","子曰：学而时习之","老吾老，以及人之老"],answer:0,userAnswer:0,isCorrect:!0,explanation:'《三字经》是中国古代蒙学读物，开头为"人之初，性本善。性相近，习相远。"表达了人性本善的儒家思想。',source:"《三字经》",difficulty:"入门级",knowledgePoints:["蒙学读物","儒家思想"]},{id:502,question:'下列哪位不是"唐宋八大家"之一？',options:["韩愈","柳宗元","欧阳修","李白"],answer:3,userAnswer:3,isCorrect:!0,explanation:'"唐宋八大家"是指唐宋时期八位散文大家，包括韩愈、柳宗元、欧阳修、苏洵、苏轼、苏辙、王安石和曾巩。李白虽然是著名诗人，但不在其中。',source:"文学史",difficulty:"普通级",knowledgePoints:["唐宋八大家","文学史"]},{id:503,question:"以下哪项不是朱熹理学思想的核心概念？",options:["理气","格物致知","诚意正心","无为而治"],answer:3,userAnswer:1,isCorrect:!1,explanation:'"无为而治"是道家思想的核心概念，而非朱熹理学的核心概念。朱熹理学强调"理气"、"格物致知"、"诚意正心"等概念，体现了儒家思想。',source:"宋明理学",difficulty:"进阶级",knowledgePoints:["宋明理学","朱熹","道家思想"]}]}),q=()=>{let s="classics";n.value.includes("quotes")?s="quotes":n.value.includes("figures")?s="figures":n.value.includes("culture")&&(s="culture");const _={classics:"经典常识测验",quotes:"名句填空测验",figures:"人物典故测验",culture:"文化常识测验"};return{id:n.value,title:_[s],completedAt:new Date,timeSpent:240,questions:[{id:101,question:s==="quotes"?"________，疑是地上霜。（李白《静夜思》）":"四书是指：",options:s!=="quotes"?["《大学》《中庸》《论语》《孟子》","《诗经》《尚书》《礼记》《周易》","《春秋》《左传》《公羊传》《谷梁传》","《道德经》《庄子》《列子》《文子》"]:null,fillIn:s==="quotes",answer:s==="quotes"?"床前明月光":0,userAnswer:s==="quotes"?"床前明月光":0,isCorrect:!0,explanation:s==="quotes"?'完整诗句为"床前明月光，疑是地上霜"，出自唐代诗人李白的《静夜思》，描绘了月光洒在床前，诗人误以为是地上的霜的情景。':"四书是指《大学》《中庸》《论语》《孟子》，是宋代理学家朱熹选定并注释的儒家经典著作。",source:s==="quotes"?"《静夜思》":"儒家经典",difficulty:"入门级",knowledgePoints:s==="quotes"?["唐诗","李白"]:["四书五经","儒家经典"]},{id:102,question:s==="quotes"?"小荷才露尖尖角，_______。（杨万里《小池》）":s==="figures"?'"负荆请罪"的主人公是：':"《道德经》的作者是：",options:s!=="quotes"?s==="figures"?["廉颇","蔺相如","李牧","白起"]:["老子","庄子","孔子","孟子"]:null,fillIn:s==="quotes",answer:s==="quotes"?"早有蜻蜓立上头":0,userAnswer:s==="quotes"?"早有蜻蜓立上头":2,isCorrect:s!=="figures",explanation:s==="quotes"?'完整诗句为"小荷才露尖尖角，早有蜻蜓立上头"，出自南宋诗人杨万里的《小池》，描绘了初夏小池塘中的生机勃勃景象。':s==="figures"?'"负荆请罪"典故出自《史记·廉颇蔺相如列传》，廉颇因误会而怨恨蔺相如，后知道蔺相如以国家利益为重而不与自己计较，感到惭愧，于是背着荆条去向蔺相如请罪。':'《道德经》又称《老子》，是道家学派创始人老子（李耳）的著作，共五千余字，分为"道经"和"德经"两部分。',source:s==="quotes"?"《小池》":s==="figures"?"《史记·廉颇蔺相如列传》":"道家经典",difficulty:"普通级",knowledgePoints:s==="quotes"?["宋诗","杨万里"]:s==="figures"?["历史典故","战国人物"]:["道家经典","老子"]}]}},w=m(()=>n.value.includes("daily")?"daily":n.value.includes("challenge")?"challenge":n.value.includes("classics")?"classics":n.value.includes("quotes")?"quotes":n.value.includes("figures")?"figures":n.value.includes("culture")?"culture":"classics");return N(()=>{h()}),(s,_)=>(c(),u("div",$e,[y.value?(c(),u("div",De,_[0]||(_[0]=[t("div",{class:"loading-spinner"},null,-1),t("p",null,"加载结果中...",-1)]))):(c(),u("div",Pe,[D(Ae,{results:v.value,"quiz-type":w.value},null,8,["results","quiz-type"])]))]))}}),Te=M(Me,[["__scopeId","data-v-b5a7bdec"]]);export{Te as default};
