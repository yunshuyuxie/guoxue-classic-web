import{d as $,f as v,c as S,v as i,x as e,D as r,Q as b,I as m,A as p,W as c,F as u,L as R,ag as T,w as n}from"./vue-DO4TrDDV.js";import{_ as U}from"./index-FWtf0PY5.js";import"./tiny-BodeErl7.js";const E={class:"forgot-container"},I={class:"forgot-card"},F={class:"steps"},B={key:0},D={class:"reset-tabs"},N={class:"form-group"},L={key:0,class:"error-message"},M={class:"form-group sms-code-group"},z={class:"sms-code-input"},A=["disabled"],Q={key:0,class:"error-message"},W=["disabled"],j={class:"form-group"},q={key:0,class:"error-message"},G={class:"form-group sms-code-group"},H={class:"sms-code-input"},J={key:0,class:"error-message"},K=["disabled"],O={key:1},X={class:"form-group"},Y={key:0,class:"error-message"},Z={class:"form-group"},ee={key:0,class:"error-message"},se=["disabled"],oe={key:2,class:"success-container"},le={class:"forgot-footer"},te=$({__name:"ForgotPasswordView",setup(ae){const _=T(),d=v("phone"),s=v({phone:"",smsCode:"",email:"",newPassword:"",confirmPassword:"",verificationCode:"",step:1}),f=v(!1),w=v(60),P=v(null),l=v({phone:"",smsCode:"",email:"",verificationCode:"",newPassword:"",confirmPassword:""}),C=S(()=>s.value.step===1?d.value==="phone"?s.value.phone&&s.value.smsCode:s.value.email&&s.value.verificationCode:s.value.step===2?s.value.newPassword&&s.value.confirmPassword&&s.value.newPassword===s.value.confirmPassword:!1),k=()=>{if(!/^1[3-9]\d{9}$/.test(s.value.phone)){l.value.phone="请输入正确的手机号";return}l.value.phone="",f.value=!0,w.value=60,P.value=window.setInterval(()=>{w.value--,w.value<=0&&(clearInterval(P.value),f.value=!1)},1e3),alert(`验证码已发送至 ${s.value.phone}`)},x=()=>{if(!/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/.test(s.value.email)){l.value.email="请输入正确的邮箱";return}l.value.email="",alert(`验证码已发送至 ${s.value.email}`)},g=()=>{let t=!1;d.value==="phone"?(s.value.phone?/^1[3-9]\d{9}$/.test(s.value.phone)?l.value.phone="":(l.value.phone="请输入正确的手机号",t=!0):(l.value.phone="请输入手机号",t=!0),s.value.smsCode?/^\d{6}$/.test(s.value.smsCode)?l.value.smsCode="":(l.value.smsCode="验证码格式错误",t=!0):(l.value.smsCode="请输入验证码",t=!0)):(s.value.email?/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/.test(s.value.email)?l.value.email="":(l.value.email="请输入正确的邮箱",t=!0):(l.value.email="请输入邮箱",t=!0),s.value.verificationCode?l.value.verificationCode="":(l.value.verificationCode="请输入验证码",t=!0)),!t&&(s.value.step=2)},V=()=>{let t=!1;s.value.newPassword?s.value.newPassword.length<6?(l.value.newPassword="密码长度不能少于6个字符",t=!0):l.value.newPassword="":(l.value.newPassword="请输入新密码",t=!0),s.value.confirmPassword?s.value.confirmPassword!==s.value.newPassword?(l.value.confirmPassword="两次输入的密码不一致",t=!0):l.value.confirmPassword="":(l.value.confirmPassword="请确认密码",t=!0),!t&&(s.value.step=3)},h=t=>{d.value=t,l.value={phone:"",smsCode:"",email:"",verificationCode:"",newPassword:"",confirmPassword:""}},y=()=>{_.push("/login")};return(t,o)=>(n(),i("div",E,[e("div",I,[o[21]||(o[21]=e("div",{class:"forgot-header"},[e("h2",null,"找回密码"),e("p",null,"重置您的国学经典账号密码")],-1)),e("div",F,[e("div",{class:r(["step",{active:s.value.step>=1,completed:s.value.step>1}])},o[8]||(o[8]=[e("div",{class:"step-number"},"1",-1),e("div",{class:"step-text"},"验证身份",-1)]),2),e("div",{class:r(["step-line",{active:s.value.step>1}])},null,2),e("div",{class:r(["step",{active:s.value.step>=2,completed:s.value.step>2}])},o[9]||(o[9]=[e("div",{class:"step-number"},"2",-1),e("div",{class:"step-text"},"设置新密码",-1)]),2),e("div",{class:r(["step-line",{active:s.value.step>2}])},null,2),e("div",{class:r(["step",{active:s.value.step>=3}])},o[10]||(o[10]=[e("div",{class:"step-number"},"3",-1),e("div",{class:"step-text"},"完成",-1)]),2)]),s.value.step===1?(n(),i("div",B,[e("div",D,[e("div",{class:r(["reset-tab",{active:d.value==="phone"}]),onClick:o[0]||(o[0]=a=>h("phone"))}," 手机号找回 ",2),e("div",{class:r(["reset-tab",{active:d.value==="email"}]),onClick:o[1]||(o[1]=a=>h("email"))}," 邮箱找回 ",2)]),d.value==="phone"?(n(),i("form",{key:0,onSubmit:b(g,["prevent"]),class:"reset-form"},[e("div",N,[o[11]||(o[11]=e("label",{for:"phone"},"手机号",-1)),m(e("input",{type:"tel",id:"phone","onUpdate:modelValue":o[2]||(o[2]=a=>s.value.phone=a),placeholder:"请输入注册时使用的手机号",class:r({error:l.value.phone}),maxlength:"11"},null,2),[[c,s.value.phone]]),l.value.phone?(n(),i("div",L,u(l.value.phone),1)):p("",!0)]),e("div",M,[o[12]||(o[12]=e("label",{for:"smsCode"},"验证码",-1)),e("div",z,[m(e("input",{type:"text",id:"smsCode","onUpdate:modelValue":o[3]||(o[3]=a=>s.value.smsCode=a),placeholder:"请输入验证码",class:r({error:l.value.smsCode}),maxlength:"6"},null,2),[[c,s.value.smsCode]]),e("button",{type:"button",class:"sms-code-button",onClick:k,disabled:f.value},u(f.value?`重新发送(${w.value}s)`:"获取验证码"),9,A)]),l.value.smsCode?(n(),i("div",Q,u(l.value.smsCode),1)):p("",!0)]),e("button",{type:"submit",class:"reset-button",disabled:!C.value},"下一步",8,W)],32)):(n(),i("form",{key:1,onSubmit:b(g,["prevent"]),class:"reset-form"},[e("div",j,[o[13]||(o[13]=e("label",{for:"email"},"邮箱",-1)),m(e("input",{type:"email",id:"email","onUpdate:modelValue":o[4]||(o[4]=a=>s.value.email=a),placeholder:"请输入注册时使用的邮箱",class:r({error:l.value.email})},null,2),[[c,s.value.email]]),l.value.email?(n(),i("div",q,u(l.value.email),1)):p("",!0)]),e("div",G,[o[14]||(o[14]=e("label",{for:"verificationCode"},"验证码",-1)),e("div",H,[m(e("input",{type:"text",id:"verificationCode","onUpdate:modelValue":o[5]||(o[5]=a=>s.value.verificationCode=a),placeholder:"请输入验证码",class:r({error:l.value.verificationCode})},null,2),[[c,s.value.verificationCode]]),e("button",{type:"button",class:"sms-code-button",onClick:x}," 获取验证码 ")]),l.value.verificationCode?(n(),i("div",J,u(l.value.verificationCode),1)):p("",!0)]),e("button",{type:"submit",class:"reset-button",disabled:!C.value},"下一步",8,K)],32))])):s.value.step===2?(n(),i("div",O,[e("form",{onSubmit:b(V,["prevent"]),class:"reset-form"},[e("div",X,[o[15]||(o[15]=e("label",{for:"newPassword"},"新密码",-1)),m(e("input",{type:"password",id:"newPassword","onUpdate:modelValue":o[6]||(o[6]=a=>s.value.newPassword=a),placeholder:"请设置新密码（不少于6位）",class:r({error:l.value.newPassword})},null,2),[[c,s.value.newPassword]]),l.value.newPassword?(n(),i("div",Y,u(l.value.newPassword),1)):p("",!0)]),e("div",Z,[o[16]||(o[16]=e("label",{for:"confirmPassword"},"确认密码",-1)),m(e("input",{type:"password",id:"confirmPassword","onUpdate:modelValue":o[7]||(o[7]=a=>s.value.confirmPassword=a),placeholder:"请再次输入新密码",class:r({error:l.value.confirmPassword})},null,2),[[c,s.value.confirmPassword]]),l.value.confirmPassword?(n(),i("div",ee,u(l.value.confirmPassword),1)):p("",!0)]),e("button",{type:"submit",class:"reset-button",disabled:!C.value},"重置密码",8,se)],32)])):(n(),i("div",oe,[o[17]||(o[17]=e("div",{class:"success-icon"},"✓",-1)),o[18]||(o[18]=e("h3",null,"密码重置成功",-1)),o[19]||(o[19]=e("p",null,"您的密码已成功重置，请使用新密码登录",-1)),e("button",{class:"reset-button",onClick:y},"返回登录")])),e("div",le,[e("p",null,[o[20]||(o[20]=R("想起密码了? ")),e("a",{href:"#",onClick:b(y,["prevent"])},"立即登录")])])])]))}}),ue=U(te,[["__scopeId","data-v-e2ccf774"]]);export{ue as default};
